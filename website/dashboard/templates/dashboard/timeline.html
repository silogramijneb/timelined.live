{% extends "dashboard/dashboard.html" %}
{% load crispy_forms_tags %}
{% block page_content %}

<div class="container-fluid px-5">
    <!-- Page Heading -->
    <div class="d-sm-flex align-items-center justify-content-between mb-4">
        <h1 class="h3 mb-0 text-gray-800">Create a new timeline</h1>
    </div>

	<div class="row" id="eventsRow">
		<div class="accordion pb-2" id="newTimeline0">
			<div class="accordion-item event-accordion" id="evAccordian0">
				<h2 class="accordion-header" id="eventNameAccordion0">
					<button id="cardTitle0" class="accordion-button" type="button" data-bs-toggle="collapse0" data-bs-target="#collapse0" aria-expanded="true" aria-controls="collapse0">New Event</button>
				</h2>
				<div id="collapse0" class="accordion-collapse collapse show" aria-labelledby="heading" data-bs-parent="#newTimeline">
					<div class="accordion-body">
						{% load crispy_forms_tags %}
                        {% csrf_token %}
                        {% crispy form %}
						<!-- <form id="timeline-event">
							<div class="form-group mt-3 mb-3">
								<select class="form-select" id="eventType">
									<option selected>Event Type</option>
									<option value="meeting">Meeting</option>
									<option value="schedule_appointment">Schedule Appointment</option>
									<option value="repair">Repair</option>
									<option value="maintenance">Maintenance</option>
									<option value="verification">Verification</option>
									<option value="inspection">Inspection</option>
									<option value="check_up">Check Up</option>
									<option value="contact">Contact</option>
									<option value="custom">Custom</option>
								</select>
							</div>
							<div class="form-floating mb-3">
								<input type="text" class="form-control" id="eventName">
								<label for="eventName">Event Name</label>
							</div>
							<div class="form-floating mb-3">
								<textarea type="text" class="form-control" id="eventDescription" style="height: 100px"></textarea>
								<label for="eventDescription">Description</label>
							</div>
							<div class="form-group mb-3">
								<select class="form-select" id="eventStatus">
									<option selected>Event Status</option>
									<option value="Unscheduled">Unscheduled</option>
									<option value="Scheduled">Scheduled</option>
									<option value="Completed">Completed</option>
									<option value="Upcoming">Upcoming</option>
									<option value="Past Due">Past Due</option>
								</select>
							</div>
							<div class="form-floating mb-3 text-center">
								<button id="createEvent" class="btn btn-success rounded-pill px-3 mt-3 mb-lg-0" type="button">Create Event</button>
							</div>
						</form> -->
					</div>
				</div>
			</div>
		</div>
		<div class="accordion pb-2" id="newTimeline1">
			<div class="accordion-item event-accordion" id="evAccordian1">
				<h2 class="accordion-header" id="eventNameAccordion1">
					<button id="cardTitle0" class="accordion-button" type="button" data-bs-toggle="collapse1" data-bs-target="#collapse1" aria-expanded="true" aria-controls="collapse1">New Event</button>
				</h2>
				<div id="collapse1" class="accordion-collapse collapse show" aria-labelledby="heading" data-bs-parent="#newTimeline">
					<div class="accordion-body">
						{% load crispy_forms_tags %}
                        {% csrf_token %}
                        {% crispy form %}
					</div>
				</div>
			</div>
		</div>
		<div class="accordion pb-2" id="newTimeline2">
			<div class="accordion-item event-accordion" id="evAccordian2">
				<h2 class="accordion-header" id="eventNameAccordion2">
					<button id="cardTitle2" class="accordion-button" type="button" data-bs-toggle="collapse2" data-bs-target="#collapse2" aria-expanded="true" aria-controls="collapse2">New Event</button>
				</h2>
				<div id="collapse2" class="accordion-collapse collapse show" aria-labelledby="heading" data-bs-parent="#newTimeline">
					<div class="accordion-body">
						{% load crispy_forms_tags %}
                        {% csrf_token %}
                        {% crispy form %}
					</div>
				</div>
			</div>
		</div>
		<div class="accordion pb-2" id="newTimeline3">
			<div class="accordion-item event-accordion" id="evAccordian3">
				<h2 class="accordion-header" id="eventNameAccordion3">
					<button id="cardTitle3" class="accordion-button" type="button" data-bs-toggle="collapse3" data-bs-target="#collapse3" aria-expanded="true" aria-controls="collapse3">New Event</button>
				</h2>
				<div id="collapse3" class="accordion-collapse collapse show" aria-labelledby="heading" data-bs-parent="#newTimeline">
					<div class="accordion-body">
						{% load crispy_forms_tags %}
                        {% csrf_token %}
                        {% crispy form %}
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
	let timeline = [];
	function createNewEvent(divNumber) {
		let submitButton = document.getElementById('createEvent');
		submitButton.style.display="None";
		let prevDivIndex = "collapse"+divNumber;
		let prevDiv = document.getElementById(prevDivIndex);
		prevDiv.className = 'accordion-collapse collapse';
		document.getElementById('cardTitle').className = 'accordion-button collapsed';
		let newDiv = prevDiv.cloneNodes(prevDiv);
		document.getElementById('eventRow').appendChild(newDiv);
	}

	function changeCardTitle() {
		let cardTitle = document.getElementById('cardTitle');
		let newTitle = document.getElementById('eventName').value;
		cardTitle.innerHTML = newTitle;
	}

	function validateForm() {
		let valid = false;
		if (valid == false) {
			changeCardTitle();
			createNewEvent();
			return false;
		} else {
			return true;
		}
	}
</script>
{% endblock %}
