{% extends "dashboard/dashboard.html" %}
{% load crispy_forms_tags %}
{% block page_content %}

<div class="container-fluid px-5">
    <!-- Page Heading -->
    <div class="d-sm-flex align-items-center justify-content-between mb-4">
        <h1 class="h3 mb-0 text-gray-800">Create a new timeline</h1>
    </div>
    <!-- Content Row -->
	<!--
    <div class="row">
		<div class="card dashboard-card">
			{% load crispy_forms_tags %}
        	<form method="POST" id="timeline-event" class="uniForm">
            	{% csrf_token %}
				<fieldset class="form-group text-center">
						<legend class="border-bottom mb-3">Event</legend>
				</fieldset>
				<div class="form-group">
					{{ form|crispy }}
				</div>
				<div class="form-group text-center">
						<button id="#createEvent" class="btn btn-success rounded-pill px-3 mt-3 mb-lg-0" type="submit" onsubmit="createNewEvent()">Create Event</button>
				</div>
        	</form>
		</div>
    </div>
	-->
	<div class="row">
		<div class="accordion" id="newTimeline">
			<div class="accordion-item event-accordion">
				<h2 class="accordion-header" id="eventNameAccordion">
					<button id="cardTitle" class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse0" aria-expanded="true" aria-controls="collapse0">New Event</button>
				</h2>
				<div id="collapse0" class="accordion-collapse collapse show" aria-labelledby="heading0" data-bs-parent="#newTimeline">
					<div class="accordion-body">
						<form onsubmit="event.preventDefault(); validateForm();" id="timeline-event">
							<div class="form-group mt-3 mb-3">
								<select class="form-select" id="eventType">
									<option selected>Event Type</option>
									<option value="meeting">Meeting</option>
									<option value="schedule_appointment">Schedule Appointment</option>
									<option value="repair">Repair</option>
									<option value="maintenance">Maintenance</option>
									<option value="verification">Verification</option>
									<option value="inspection">Inspection</option>
									<option value="check_up">Check Up</option>
									<option value="contact">Contact</option>
									<option value="custom">Custom</option>
								</select>
							</div>
							<div class="form-floating mb-3">
								<input type="text" class="form-control" id="eventName" onsubmit="changeCardTitle()">
								<label for="eventName">Event Name</label>
							</div>
							<div class="form-floating mb-3">
								<textarea type="text" class="form-control" id="eventDescription" style="height: 100px"></textarea>
								<label for="eventDescription">Description</label>
							</div>
							<div class="form-group mb-3">
								<select class="form-select" id="eventStatus">
									<option selected>Event Status</option>
									<option value="Unscheduled">Unscheduled</option>
									<option value="Scheduled">Scheduled</option>
									<option value="Completed">Completed</option>
									<option value="Upcoming">Upcoming</option>
									<option value="Past Due">Past Due</option>
								</select>
							</div>
							<div class="form-floating mb-3 text-center">
								<button id="createEvent" class="btn btn-success rounded-pill px-3 mt-3 mb-lg-0" type="button" onsubmit="createNewEvent(0)">Create Event</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script>

	let timeline = [];
	function createNewEvent(divNumber) {
		let submitButton = document.getElementById('createEvent');
		submitButton.style.display="None";
		let prevDivIndex = "collapse"+divNumber;
		let prevDiv = document.getElementById(prevDivIndex);
		console.log("This is working!!");
	}

	function changeCardTitle() {
		let cardTitle = document.getElementById('cardTitle');
		let newTitle = document.getElementById('eventName').value;
		cardTitle.innerHTML = newTitle;
	}

	function validateForm() {
		let valid = false;
		if (valid == false) {
			changeCardTitle();
			createNewEvent();
			return false;
		} else {
			return true;
		}
	}
</script>
{% endblock %}
